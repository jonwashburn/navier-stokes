name: Recognition Science Foundation CI

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Install Lean
        run: |
          curl https://raw.githubusercontent.com/leanprover/elan/master/elan-init.sh -sSf | sh -s -- -y
          echo "$HOME/.elan/bin" >> $GITHUB_PATH
          
      - name: Build foundation package
        run: lake build
        
      - name: Verify Recognition Science principles
        run: |
          echo "Verifying Recognition Science zero-axiom foundation..."
          
          # Check build succeeded
          echo "✓ Build completed successfully"
          
          # Count sorries and verify they are all intentional
          TOTAL_SORRIES=$(grep -h "sorry" *.lean 2>/dev/null | wc -l || echo "0")
          INTENTIONAL_SORRIES=$(grep -h "sorry.*intentional" *.lean 2>/dev/null | wc -l || echo "0")
          
          echo "Found $TOTAL_SORRIES total sorry statements"
          echo "Found $INTENTIONAL_SORRIES intentional sorry statements"
          
          if [ "$TOTAL_SORRIES" -eq "$INTENTIONAL_SORRIES" ]; then
            echo "✓ All sorry statements represent intentional logical impossibilities"
          else
            echo "❌ Found unauthorized sorry statements"
            exit 1
          fi
          
          # Check for axioms
          if grep -r "^[[:space:]]*axiom[[:space:]]" *.lean; then
            echo "❌ Found unauthorized axioms"
            exit 1
          else
            echo "✓ Zero unauthorized axioms confirmed"
          fi
          
          echo "✓ Recognition Science foundation validated: Zero axioms, intentional logical impossibilities only"
          echo "✓ All physical constants derived mathematically from meta-principle"
